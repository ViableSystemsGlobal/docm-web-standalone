(()=>{var e={};e.id=8746,e.ids=[8746],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},20993:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>c,serverHooks:()=>m,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{POST:()=>u});var o=r(96559),i=r(48088),n=r(37719),a=r(32190);let l=(0,r(39398).createClient)("https://ufjfafcfkalaasdhgcbi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVmamZhZmNma2FsYWFzZGhnY2JpIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NzcxNDcxMywiZXhwIjoyMDYzMjkwNzEzfQ.WakMPKwx47UPsmBPIE0uEMT31EMluTw6z1PpJKswMnA");async function u(e){try{let{name:t,email:r,phone:s,subject:o,category:i,message:n,newsletter:u,prayer:c}=await e.json();if(console.log("\uD83D\uDCE7 Contact form submission received:",{name:t,email:r,subject:o,category:i,prayer:c,newsletter:u}),!t||!r||!o||!n)return a.NextResponse.json({error:"Missing required fields"},{status:400});let p=crypto.randomUUID(),d=new Date().toISOString(),m=null;if(console.log("\uD83D\uDD0D Newsletter check:",{newsletter:u,type:typeof u,truthyCheck:!0===u||"true"===u||1===u}),!0===u||"true"===u||1===u)try{console.log("\uD83D\uDCE7 Adding newsletter subscription...");let e={email:r,first_name:t.split(" ")[0]||t,last_name:t.split(" ").slice(1).join(" ")||"",subscribed_at:d,status:"active",subscription_source:"contact_form"};console.log("\uD83D\uDCE7 Newsletter payload:",e);let{data:s,error:o}=await l.from("newsletter_subscribers").insert([e]).select();o?(console.error("❌ Newsletter subscription error:",o),console.error("❌ Newsletter error details:",JSON.stringify(o,null,2))):(m=s?.[0],console.log("✅ Newsletter subscription added:",m?.id),console.log("✅ Newsletter full result:",m))}catch(e){console.error("❌ Newsletter subscription failed:",e)}else console.log("\uD83D\uDCE7 Newsletter subscription skipped - condition not met");let y=!0===c||"true"===c||1===c||"Prayer Request"===i;console.log("\uD83D\uDD0D Prayer request check:",{prayer:c,category:i,type:typeof c,isPrayerRequest:y}),console.log("\uD83D\uDCDD Attempting to insert into website_messages table...");let g={id:p,name:t,email:r,phone:s||null,subject:o,category:i||(y?"Prayer Request":"General Inquiry"),message:n,source:"website",newsletter_opt_in:u||!1,submitted_at:d,status:"unread",is_prayer_request:y};console.log("\uD83D\uDCDD Website message payload:",g);let{data:b,error:f}=await l.from("website_messages").insert([g]).select();if(f){console.error("❌ Error inserting website message:",f),console.error("❌ Error details:",JSON.stringify(f,null,2)),console.log("\uD83D\uDCDD Attempting fallback to contact_submissions...");let{data:e,error:c}=await l.from("contact_submissions").insert([{id:p,name:t,email:r,phone:s||null,subject:o,category:i||(y?"Prayer Request":"General Inquiry"),message:n,newsletter_opt_in:u||!1,is_prayer_request:y,submitted_at:d,status:"new"}]).select();if(c)return console.error("❌ Error inserting to contact_submissions:",c),a.NextResponse.json({error:"Failed to submit contact form"},{status:500});console.log("✅ Message submitted to contact_submissions (fallback):",p)}else console.log("✅ Website message submitted to admin outreach successfully:",p),console.log("✅ Inserted data:",b);if(y)try{console.log("\uD83D\uDE4F Adding prayer request to pastoral team...");let e={id:crypto.randomUUID(),contact_id:null,title:o,description:n,status:"new",submitted_at:d,urgency:"normal",is_confidential:!0,source:"website",source_submission_id:p};console.log("\uD83D\uDE4F Prayer request payload:",e);let{data:t,error:r}=await l.from("prayer_requests").insert([e]).select();r?(console.error("❌ Prayer request submission error:",r),console.error("❌ Prayer error details:",JSON.stringify(r,null,2))):(console.log("✅ Prayer request also submitted to pastoral team:",t?.[0]?.id),console.log("✅ Prayer full result:",t))}catch(e){console.error("❌ Prayer request submission failed:",e)}else console.log("\uD83D\uDE4F Prayer request skipped - not a prayer request");let w=y?"Your prayer request has been submitted. Our pastoral team will keep you in prayer.":"Your message has been sent successfully! We'll get back to you soon.",q=m?" You've also been subscribed to our newsletter.":"";return console.log("✅ Contact form submission completed successfully"),a.NextResponse.json({success:!0,message:w+q,submission_id:p,type:y?"prayer_request":"website_message",newsletter_subscribed:!!m,debug:{newsletterResult:!!m,newsletterResultId:m?.id,isPrayerRequest:y,originalValues:{newsletter:u,prayer:c}}},{status:200})}catch(e){return console.error("❌ Error processing contact form:",e),a.NextResponse.json({error:"Internal server error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},resolvedPagePath:"/Users/nanasasu/docm-web-standalone/src/app/api/contact/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:d,serverHooks:m}=c;function y(){return(0,n.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:d})}},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},51906:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=51906,e.exports=t},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,9398,580],()=>r(20993));module.exports=s})();